
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>WebSocket Test</title>
</head>
<script type="text/javascript" src="jquery.js">

</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
<link rel="stylesheet" href="style.css" charset="utf-8">
<body>

  <div class="parallax-container">
    <div class="parallax">
        <img src="https://onepagelove.com/wp-content/uploads/2014/03/opl-parallax-universe.jpg" />
    </div>
  </div>

  <div class="centerContainer">
    <div class="whiteBackground">
    <h2 class="header">Simple Chat</h2>
    <ul class="collection">
      <div id="log"></div>
    </ul>
    <input type="text" name="text" value="" id="inpText">
    <button type="button" name="Username festlegen" id="setUsername" class="waves-effect waves-light btn">Set username</button>
    <button id="test" class="waves-effect waves-light btn">Click me to Send messages.</button>
  </div>

</div>
</body>
<script>
$(document).ready(function(){
    $('.parallax').parallax();
});

  var wsocket;

  function connect() {
    wsocket = new WebSocket("ws://gambopower.ddns.net:8080/WebsocketChat/chat");
    wsocket.onmessage = function(event) {
      console.log(event.data);
      $("#log").append("<li class=\"collection-item\">" + event.data + "</li>");
    };
  }
  window.addEventListener("load", connect, false);

  $(document).ready(function() {
    $("#setUsername").click(function() {
      var username = prompt("Whats ur username?");
      wsocket.send("Username:" + username);
    });
	   $("#test").click(function() {
       var textToSend = $("#inpText").val();
       if(wsocket.readyState == 1){
           wsocket.send(textToSend);
         }
       else{
           wsocket.onopen = function(e){
               websocket.send(textToSend);
           }
       }
       $("#inpText").val("");
    });

    $('#inpText').keypress(function (e) {
      if (e.which == 13) {
        var textToSend = $("#inpText").val();
        if(wsocket.readyState == 1){
            wsocket.send(textToSend);
          }
        else{
            wsocket.onopen = function(e){
                websocket.send(textToSend);
            }
        }
        $("#inpText").val("");
    }
  });

});

</script>
</html>
